---
layout: default
title: üìí 1–° –±—ç–∫–∞–ø –±–∞–∑—ã —Å –ø–æ–º–æ—â—å—é PowerShell
nav_order: 80
---

# 1–° –±—ç–∫–∞–ø –±–∞–∑—ã —Å –ø–æ–º–æ—â—å—é PowerShell

## –°–∫—Ä–∏–ø—Ç
---
–°–æ–∑–¥–∞–µ–º –ø–∞–ø–∫—É `C:\distr\it_dept`

–°–æ–∑–¥–∞–µ–º —Ç–µ–∫—Å—Ç–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç –∏ —Ä–∞–∑–º–µ—â–∞–µ–º –µ–≥–æ –≤ `C:\distr\backup_it_dept_dt.ps1`

```powershell
$date = get-date
$DateStr = $date.ToString("yyyy-MM-dd")

Write-Host($DateStr)

$server1c = "–ò–º—è–°–µ—Ä–≤–µ—Ä–∞1–°"
$base1c = "–ò–º—è–ë–∞–∑—ã1–°"
$user = '"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å 1–°"'
$pwd = '"–ü–∞—Ä–æ–ª—å–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"'
$dest = "C:\distr\it_dept\it_dept_" + $DateStr + ".dt"
$log = "C:\distr\it_dept\it_dept_" + $DateStr + ".log"

$cestart = '"C:\Program Files\1cv8\common\1cestart.exe"'
$params = ' CONFIG /S' + $server1c + '\' + $base1c + ' /N' + $user + ' /P' + $pwd + ' /Out' + $log + ' /DumpIB' + $dest

# $bak_command = $cestart + $params

$Connector = New-Object -comObject V83.ComConnector
$Agent = $Connector.ConnectAgent($base1c)
$Cluster = $Agent.GetClusters().GetValue(0)
$Agent.Authenticate($Cluster, "", "")
$Processes = $Agent.GetWorkingProcesses($Cluster);
# echo $Processes

$Bases = $Agent.GetInfoBases($Cluster)
# echo $Bases

ForEach ($Base in $Bases) {
    # write-host($Base.name)
    if($Base.name -eq $base1c){
        # write-host($Base.name)
        $Sessions = $Agent.GetInfoBaseSessions($Cluster, $Base);
        ForEach ($Session in $Sessions){
        $Agent.TerminateSession($Cluster, $Session);
        }
    }
}

Start-Process $cestart $params
```


## –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞–Ω–∏–π
---
![[Pasted image 20251209191539.png]]


![[Pasted image 20251209191549.png]]
- –î–µ–π—Å—Ç–≤–∏–µ: –ó–∞–ø—É—Å–∫ –∫–æ–º–∞–Ω–¥—ã

- –ü—Ä–æ–≥—Ä–∞–º–º–∞ –∏–ª–∏ —Å—Ü–µ–Ω–∞—Ä–∏–π: 
```
powershell
```

- –î–æ–±–∞–≤–∏—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç—ã:
```
-ExecutionPolicy bypass -File "C:\distr\backup_it_dept_dt.ps1"
```

–ü—Ä–æ–≤–µ—Ä—è–µ–º

![[Pasted image 20251209191607.png]]



## –°–º. —Ç–∞–∫–∂–µ

- [[2021-12-13-1c_srv_ib_list]]
- [[2025-08-14-1c-cluster-config]]
